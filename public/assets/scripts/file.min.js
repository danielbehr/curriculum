
function fileChange(d,b,h,g,e,i,j,a){if(typeof(d)==="undefined"){d=""}if(typeof(b)==="undefined"){b=d+"_fSelector"}if(typeof(h)==="undefined"){h=d+"_fName"}if(typeof(g)==="undefined"){g=d+"_fSize"}if(typeof(e)==="undefined"){e=d+"_fType"}if(typeof(i)==="undefined"){i=d+"_fUpload"}if(typeof(j)==="undefined"){j=d+"_fProgress"}if(typeof(a)==="undefined"){a=d+"_fPercent"}var k=document.getElementById(b).files;var f=k[0];if(!f){return}document.getElementById(b).style.visibility="hidden";document.getElementById(h).innerHTML=f.name;document.getElementById(g).innerHTML="Dateigröße: "+formatBytes(f.size,1);document.getElementById(e).innerHTML="Dateityp: "+f.type;$(document.getElementById(h)).removeClass("hidden");$(document.getElementById(g)).removeClass("hidden");$(document.getElementById(e)).removeClass("hidden");$(document.getElementById(i)).removeClass("hidden");$(document.getElementById(j)).removeClass("hidden");document.getElementById(j+"_bar").style.width="0%";document.getElementById(a).innerHTML="0%"}var client=null;function uploadFile(d,f,b,i,j,a){if(typeof(d)==="undefined"){d=""}if(typeof(f)==="undefined"){f=d+"_import"}if(typeof(b)==="undefined"){b=d+"_fSelector"}if(typeof(i)==="undefined"){i=d+"_fName"}if(typeof(j)==="undefined"){j=d+"_fProgress"}if(typeof(a)==="undefined"){a=d+"_fPercent"}if(typeof(fAbort)==="undefined"){fAbort=d+"_fAbort"}if(f==="import"){$(document.getElementById("form_curriculum")).removeClass("hidden")}$(document.getElementById(d+"_fAbort")).removeClass("hidden");var g=document.getElementById(b).files[0];var e=new FormData();client=new XMLHttpRequest();var h=document.getElementById(j);if(!g){return}h.value=0;h.max=100;e.append("upload",g);if(document.getElementById("uploadform")!==null){e.append("action",document.getElementById("action").value);e.append("ref_id",document.getElementById("ref_id").value);e.append("target",document.getElementById("target").value);e.append("format",document.getElementById("format").value);e.append("context",document.getElementById("context").value);e.append("title",document.getElementById("title").value);e.append("description",document.getElementById("description").value);e.append("license",document.getElementById("license").value);e.append("file_context",document.getElementById("file_context").value)}if(f==="import"){e.append("context","backup")}client.onerror=function(k){alert("onError")};client.onload=function(k){document.getElementById(a).innerHTML="100%";h.value=h.max};client.upload.onprogress=function(l){var k=Math.round(100/l.total*l.loaded);document.getElementById(j+"_bar").style.width=k+"%";document.getElementById(a).innerHTML=k+"%";if(k===100){if(f==="import"){document.getElementById(d).style.display="none";$(document.getElementById("bImport")).removeClass("hidden")}}};client.onloadend=function(k){if(f==="import"){c=new Array();c=setFormData(g.name);document.getElementById("importFileName").value=document.getElementById(i).innerHTML;document.getElementById("func").value=f}else{target=document.getElementById("target").value;$.nmTop().close();if($("#"+target).get(0)){document.getElementById(target).value=client.responseText;$("#"+target).trigger("change")}if(document.getElementById("context").value==="terminal_objective"||document.getElementById("context").value==="enabling_objective"||document.getElementById("context").value==="task"){parent.window.location.reload()}}};client.onabort=function(k){alert("Upload abgebrochen")};client.open("POST","../share/processors/fp_upload.php");client.send(e)}function uploadURL(){var a=new FormData();client=new XMLHttpRequest();if(typeof(document.getElementById("uploadform"))!=="undefined"){a.append("action",document.getElementById("action").value);a.append("ref_id",document.getElementById("ref_id").value);a.append("target",document.getElementById("target").value);a.append("format",document.getElementById("format").value);a.append("context",document.getElementById("context").value);a.append("title",document.getElementById("title").value);a.append("description",document.getElementById("description").value);a.append("license",document.getElementById("license").value);a.append("file_context",document.getElementById("file_context").value);a.append("fileURL",document.getElementById("fileURL").value)}client.onerror=function(b){alert("onError")};client.onloadend=function(b){setTarget(client.responseText)};client.open("POST","../share/processors/fp_upload.php");client.send(a)}function uploadAbort(){if(client instanceof XMLHttpRequest){client.abort()}}function setTarget(a){$.nmTop().close();target=document.getElementById("target").value;if($("#"+target).get(0)){document.getElementById(target).value=a;$("#"+target).trigger("change")}if(document.getElementById("context").value==="terminal_objective"||document.getElementById("context").value==="enabling_objective"||document.getElementById("context").value==="task"){parent.window.location.reload()}};